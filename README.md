# Python 代码查重工具

一个基于多种相似度算法的Python代码查重工具，支持批量导入、历史记录管理和抄袭判定功能。

## 功能特性

### 核心功能
- **1对多查询模式**：支持批量导入同一目录下的Python代码文件
- **多维度相似度分析**：使用6种不同的相似度算法进行综合分析
- **可视化结果展示**：在GUI中按重复率降序排列展示查重结果
- **代码高亮对比**：点击结果条目可详细显示两份代码的具体内容，高亮标记相似和不同代码段

### 相似度算法
1. **综合可疑度**：综合所有单一指标的加权平均分
2. **逻辑顺序相似度**：衡量代码逻辑顺序的相似性
3. **结构指纹相似度**：比较代码架构和结构的相似性
4. **词汇重合度**：分析变量名、函数名等词汇的相似性
5. **序列匹配度**：寻找最长连续匹配代码块
6. **语法构成相似度**：比较编程风格和语法元素使用频率

### 历史记录功能
- **登录时间记录**：记录并显示用户登录时间
- **分析会话管理**：自动保存每次导入的查重结果
- **历史结果查看**：支持直接显示过往的查重结果，无需重新分析
- **会话持久化**：分析结果自动保存到本地文件

### 抄袭判定管理
- **人工标记功能**：支持对每两份代码的查重结果进行人工抄袭判定
- **备注系统**：可为每个抄袭判定添加详细备注说明
- **状态可视化**：在结果列表中显示抄袭标记状态
- **右键菜单**：通过右键菜单快速标记或编辑抄袭状态

### 导出功能
- **抄袭报告导出**：导出所有被判定抄袭的详细报告（JSON格式）
- **抄袭文件导出**：导出所有被判定抄袭的代码文件
- **时间戳命名**：导出的文件自动添加时间戳避免冲突

## 安装和运行

### 环境要求
- Python 3.7+
- PyQt5

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python main.py
```

## 使用说明

### 基本操作
1. **导入代码目录**：点击"导入目录"按钮选择包含Python文件的目录
2. **开始查重**：点击"开始查重"按钮执行分析
3. **查看结果**：在中间的结果列表中查看查重结果
4. **详细对比**：双击结果条目查看代码详细对比

### 历史记录使用
1. **查看历史**：在左侧历史记录区域查看所有分析会话
2. **加载历史**：双击历史会话可重新加载该会话的结果
3. **刷新记录**：点击"刷新"按钮更新历史记录显示

### 抄袭判定操作
1. **标记抄袭**：在结果列表中右键点击条目，选择"标记为抄袭"
2. **添加备注**：在标记对话框中添加详细的判定备注
3. **编辑状态**：右键选择"编辑备注"可修改抄袭状态和备注
4. **查看备注**：右键选择"查看备注"查看当前备注信息

### 导出功能
1. **导出报告**：在历史记录区域点击"导出抄袭报告"
2. **导出文件**：在历史记录区域点击"导出抄袭文件"
3. **选择位置**：选择保存位置和文件名

## 文件结构

```
pycode_checker/
├── main.py                 # 程序入口
├── requirements.txt        # 依赖包列表
├── model/                  # 数据模型
│   ├── file_manager.py     # 文件管理
│   ├── history_manager.py  # 历史记录管理
│   └── similarity/         # 相似度分析模块
│       ├── analyzer.py     # 分析器
│       ├── result.py       # 结果数据结构
│       ├── metrics.py      # 相似度算法
│       └── ...
├── view/                   # 用户界面
│   ├── main_window.py      # 主窗口
│   ├── result_list.py      # 结果列表视图
│   ├── detail_view.py      # 详细对比视图
│   └── history_view.py     # 历史记录视图
├── controller/             # 控制器
│   └── main_controller.py  # 主控制器
└── history/                # 历史记录存储目录
    └── analysis_history.json
```

## 技术特点

- **模块化设计**：清晰的MVC架构，便于维护和扩展
- **数据持久化**：使用JSON格式保存历史记录和抄袭判定
- **用户友好**：直观的图形界面和右键菜单操作
- **高性能**：优化的算法实现，支持大量文件快速分析
- **可扩展性**：易于添加新的相似度算法和功能模块

## 注意事项

- 程序会自动创建`history`目录用于存储历史记录
- 抄袭判定信息会与历史记录一起保存
- 导出的文件会添加时间戳以避免文件名冲突
- 建议定期备份历史记录文件